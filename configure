#!/bin/bash

ok=0

checkinclude()
{
	printf "checking for $1... "
	
	# only the preprocessor is needed check for the libaries
	if ! gcc -o /dev/null -L /usr/local/lib/ -l$1 check$$.c &> /dev/null;
	then
		printf "\n\tYou do not seem to have $1\n"
		return 1
	else
		echo ok
		return 0
	fi
}

if [ $1 ]; then
	echo
	echo This script takes no arguments.
	echo
fi

cat > check$$.c <<- EOF
	int main(){}
EOF
	
if ! checkinclude netfilter_conntrack; then
	printf "\tIt can be found at ftp.netfilter.org.  "
	printf "You will also need libnfnetlink.\n"
	ok=1
fi

if ! checkinclude netfilter_queue; then
	printf "\tIt can be found at ftp.netfilter.org.\n"
	ok=1
fi

rm check$$.c

echo
if [[ $ok -eq 0 ]]; then
	echo Ready to compile.  Say \'make\'.
	echo
else
	echo I found problems, but you could try running 'make' anyway.
fi
